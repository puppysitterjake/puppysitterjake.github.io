<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>puppysitter üêæ</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
/* ... (Gi·ªØ nguy√™n ph·∫ßn CSS c≈© c·ªßa b·∫°n) ... */
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,sans-serif;}
body{background:#0b132b;color:white;scroll-behavior:smooth;}
.topbar{position:absolute;top:0;width:100%;height:70px;display:flex;align-items:center;justify-content:space-between;padding:0 7%;z-index:100;}
.logo{font-weight:800;font-size:22px;letter-spacing:1px;}
.nav a{margin-left:25px;color:white;text-decoration:none;font-size:14px;opacity:.85;transition:.2s;}
.nav a:hover{opacity:1;}
.hero{height:100vh;position:relative;overflow:hidden;}
.hero img{position:absolute;width:100%;height:100%;object-fit:cover;opacity:0;transition:1.2s;}
.hero img.active{opacity:1;}
section{max-width:1200px;margin:auto;padding:100px 20px;}
h2{font-size:32px;margin-bottom:35px;font-weight:800;}
.grid{display:grid;gap:26px;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));}
.card{background:white;color:#111;border-radius:20px;overflow:hidden;cursor:pointer;transition:.25s;box-shadow:0 6px 20px rgba(0,0,0,.25);}
.card:hover{transform:translateY(-6px);}
.thumb{width:100%;aspect-ratio:16/9;object-fit:cover;background:#eee; display: block;}
.content{padding:16px;}
.title{font-weight:700;font-size:15px;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
.desc{font-size:13px;color:#666;margin-top:6px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
.embed{border-radius:18px;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,.35);}
#spotify,#apple{padding-top:70px;}
</style>
</head>

<body>

<header class="topbar">
  <div class="logo">puppysitter üêæ</div>
  <nav class="nav">
    <a href="#notice">Notice</a>
    <a href="#youtube">YouTube</a>
    <a href="#spotify">Spotify</a>
    <a href="#apple">Apple</a>
  </nav>
</header>

<div id="hero" class="hero"></div>

<section id="notice">
  <h2>Notice (B√°o ch√≠ & Tin t·ª©c)</h2>
  <div id="notice-list" class="grid"></div>
</section>

<section id="youtube">
  <h2>YouTube</h2>
  <div id="youtube-list" class="grid"></div>
</section>

<section id="spotify">
  <h2>Spotify</h2>
  <div id="spotify-list" class="grid"></div>
</section>

<section id="apple">
  <h2>Apple Music</h2>
  <div id="apple-list" class="grid"></div>
</section>

<script>
const SHEET="1JbONtH3RWufz3RSgs3EnMV9cYd_37xwBOHgaU2y_yCs";
const API=s=>`https://opensheet.elk.sh/${SHEET}/${s}`;
const get=s=>fetch(API(s)).then(r=>r.json());

/* 1. X·ª¨ L√ù THUMBNAIL YOUTUBE */
function ytThumb(url){
  try{
    const u=new URL(url);
    let id = "";
    if(u.hostname.includes("youtu.be")) id = u.pathname.slice(1);
    else if(u.searchParams.get("v")) id = u.searchParams.get("v");
    if(id) return `https://img.youtube.com/vi/${id}/mqdefault.jpg`;
  }catch{}
  return null;
}

/* 2. X·ª¨ L√ù PREVIEW B√ÅO CH√ç (S·ª≠ d·ª•ng Microlink API mi·ªÖn ph√≠) */
function getLinkPreview(url) {
    // N·∫øu l√† link youtube, d√πng ·∫£nh youtube
    let yt = ytThumb(url);
    if(yt) return yt;
    
    // N·∫øu l√† link b√°o, d√πng d·ªãch v·ª• Microlink ƒë·ªÉ l·∫•y ·∫£nh Open Graph
    // ƒê√¢y l√† c√°ch ƒë∆°n gi·∫£n nh·∫•t ƒë·ªÉ v∆∞·ª£t l·ªói CORS v√† l·∫•y ·∫£nh t·ª´ link b·∫•t k·ª≥
    return `https://api.microlink.io/?url=${encodeURIComponent(url)}&embed=image.url`;
}

/* 3. HERO SLIDER */
async function loadHero(){
  try {
    const d=await get("HERO");
    const box=document.getElementById("hero");
    d.forEach((r,i)=>{
      const img=document.createElement("img");
      img.src=r.image;
      if(i===0) img.classList.add("active");
      box.appendChild(img);
    });
    const imgs=box.querySelectorAll("img");
    let i=0;
    if(imgs.length > 0) {
        setInterval(()=>{
          imgs[i].classList.remove("active");
          i=(i+1)%imgs.length;
          imgs[i].classList.add("active");
        },4000);
    }
  } catch(e) {}
}

/* 4. CARD LIST (NOTICE & YOUTUBE) */
async function loadList(sheet, id){
  const d=await get(sheet);
  const box=document.getElementById(id);

  d.forEach(r=>{
    // L·∫•y ·∫£nh: ∆Øu ti√™n ·∫£nh trong c·ªôt 'image', n·∫øu kh√¥ng c√≥ th√¨ t·ª± t√¨m preview t·ª´ 'url'
    const thumb = r.image ? r.image : getLinkPreview(r.url);

    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <img class="thumb" src="${thumb}" onerror="this.src='https://via.placeholder.com/400x225?text=No+Image'">
      <div class="content">
        <div class="title">${r.title || "ƒêang c·∫≠p nh·∫≠t..."}</div>
        <div class="desc">${r.desc || ""}</div>
      </div>
    `;
    div.onclick=()=>window.open(r.url);
    box.appendChild(div);
  });
}

/* 5. IFRAME (SPOTIFY/APPLE) */
async function loadIframe(sheet,id){
  try {
    const d=await get(sheet);
    const box=document.getElementById(id);
    d.forEach(r=>{
      if(r.iframe) {
          const div=document.createElement("div");
          div.className="embed";
          div.innerHTML=r.iframe;
          box.appendChild(div);
      }
    });
  } catch(e) {}
}

/* KH·ªûI T·∫†O */
loadHero();
loadList("NOTICE","notice-list"); // Notice gi·ªù s·∫Ω t·ª± nh·∫≠n di·ªán link b√°o
loadList("YOUTUBE","youtube-list");
loadIframe("SPOTIFY","spotify-list");
loadIframe("APPLE","apple-list");

</script>
</body>
</html>
